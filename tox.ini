[tox]
requires =
    tox>=4.0
env_list =
    py{310,311,312,313}
    ruff
    black
    coverage

[gh-actions]
python =
    3.10: py310
    3.11: py311
    3.12: py312
    3.13: py313

[testenv]
description = Run tests with pytest and coverage
deps =
    pytest>=8.0
    pytest-cov>=5.0
    pyyaml
    rich
    restrictedpython
    voluptuous
    click
commands = 
    pytest {posargs}
passenv = 
    PYTHONPATH
    HOME
    CI

[testenv:ruff]
description = Run ruff linter and formatter check
skip_install = false
deps =
    ruff>=0.6
commands =
    ruff check baygon tests
    ruff format --check baygon tests

[testenv:black]
description = Check code formatting with black
skip_install = false
deps =
    black>=24.0
commands =
    black --check baygon tests

[testenv:format]
description = Format code with ruff and black
skip_install = false
deps =
    ruff>=0.6
    black>=24.0
commands =
    ruff check --fix baygon tests
    ruff format baygon tests
    black baygon tests

[testenv:coverage]
description = Run tests with detailed coverage report
deps =
    pytest>=8.0
    pytest-cov>=5.0
    pyyaml
    rich
    restrictedpython
    voluptuous
    click
commands =
    pytest --cov=baygon --cov-report=term-missing --cov-report=html --cov-report=xml

[testenv:docs]
description = Build documentation
changedir = docs
deps =
    mkdocs>=1.6
    mkdocs-material>=9.5
    mkdocs-exclude>=1.0
    mkdocs-redirects>=1.2
    mkdocstrings-python>=1.12
commands =
    mkdocs build --clean
